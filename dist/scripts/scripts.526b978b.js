"use strict";angular.module("ngSwApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","toastr","ne.swapi","colorpicker.module"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl",controllerAs:"about"}).when("/faceSettings/:uid?",{templateUrl:"views/facesettings.html",controller:"FacesettingsCtrl",controllerAs:"faceSettings"}).when("/swapitest",{templateUrl:"views/swapitest.html",controller:"SwapitestCtrl",controllerAs:"swapitest"}).when("/processing",{templateUrl:"views/processing.html",controller:"ProcessingCtrl",controllerAs:"processing"}).otherwise({redirectTo:"/"})}]),angular.module("ngSwApp").controller("MainCtrl",[function(){}]),angular.module("ngSwApp").controller("AboutCtrl",[function(){this.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),function(){navigator.getMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,window.hasUserMedia=function(){return navigator.getMedia?!0:!1}}(),angular.module("ngSwApp").directive("webcam",["toastr","betaface","$routeParams","$location",function(a,b,c,d){return{template:'<div class="webcam-container"><div class="row"><div class="col-lg-6 col-sm-12 text-center"><button class="btn btn-lg btn-default" ng-click="savePhoto()" ng-disabled="!photoReady">Take Photo</button></div><div class="col-lg-6 col-sm-12 text-center"><button class="btn btn-lg btn-default" ng-click="uploadPhoto()" ng-disabled="!uploadReady">Upload Photo</button></div></div><!-- webcam itself is inserted below --><div class="row"><div class="webcam-video col-lg-6 col-sm-12 text-center"></div><div class="webcam-photo col-lg-6 col-sm-12 text-center"></div></div></div>',restrict:"E",replace:!0,transclude:!0,scope:{onError:"&",onStream:"&",onStreaming:"&",placeholder:"=",config:"=channel"},link:function(c,e){var f=null,g=null,h=null;c.config=c.config||{},c.photoReady=!1,c.uploadReady=!1;var i=function(a){a&&angular.element(a).remove()},j=function(){g&&"function"==typeof g.stop&&g.stop(),f&&delete f.src},k=function(b){if(a.success("Photon receptor detected"),g=b,navigator.mozGetUserMedia)f.mozSrcObject=b;else{var d=window.URL||window.webkitURL;f.src=d.createObjectURL(b)}f.play(),c.config.video=f,c.onStream&&c.onStream({stream:b}),c.photoReady=!0},l=function(b){a.warning("Falling back to manual entry","Photon receptor failure"),i(h),console&&console.log&&console.log("Webcam initialization failed: ",b),c.onError&&c.onError({err:b}),d.path("/faceSettings")},m=(c.savePhoto=function(){if(!c.config.canvas){var a=document.createElement("canvas");a.setAttribute("width",f.videoWidth),a.setAttribute("height",f.videoHeight),e.find(".webcam-photo").append(a),c.config.canvas=a}var b=c.config.canvas,d=b.getContext("2d");d.drawImage(f,0,0,f.width,f.height),c.imgData=b.toDataURL("image/png"),c.uploadReady=!0},c.uploadPhoto=function(){var e=c.imgData,f=b.upload(e);f.$promise.then(function(a){d.path("/faceSettings/"+a.img_uid)},function(b){a.warning("Manual processing fallback engaged","Photon pattern recognition failed"),d.path("/faceSettings")})},function(){f=document.createElement("video"),f.setAttribute("class","webcam-live"),f.setAttribute("autoplay",""),e.find(".webcam-video").append(f),c.placeholder&&(h=document.createElement("img"),h.setAttribute("class","webcam-loader"),h.src=c.placeholder,e.find(".webcam-video").append(h));var a=!1,b=e.width=c.config.videoWidth||320,d=e.height=0;if(!window.hasUserMedia())return void l({code:-1,msg:"Browser does not support getUserMedia."});var g={video:!0,audio:!1};navigator.getMedia(g,k,l),f.addEventListener("canplay",function(){if(!a){var e=b/f.videoWidth;d=f.videoHeight*e||c.config.videoHeight,f.setAttribute("width",b),f.setAttribute("height",d),a=!0,c.config.video=f,i(h),c.onStreaming&&c.onStreaming()}},!1)}),n=function(){j(),f.remove()};c.$on("$destroy",j),c.$on("START_WEBCAM",m),c.$on("STOP_WEBCAM",n),m()}}}]),angular.module("ngSwApp").service("betaface",["$resource","guid",function(a,b){function c(a){console.log(a)}var d="d45fd466-51e2-4701-8da8-04351c872236",e="171e8465-f548-401d-b63b-caf0dc28df5f",f="http://www.betafaceapi.com/service_json.svc/",g={uploadImage:{method:"POST",params:{},url:f+"UploadImage"},getInfo:{method:"POST",params:{},url:f+"GetImageInfo"}},h=a(f,{},g);this.upload=function(a){return a=a.split(",")[1],h.uploadImage({},{api_key:d,api_secret:e,original_filename:""+b.generate()+".jpg",detection_flags:"extended,classifiers",image_base64:a},c,c)},this.getInfo=function(a){return h.getInfo({},{api_key:"d45fd466-51e2-4701-8da8-04351c872236",api_secret:"171e8465-f548-401d-b63b-caf0dc28df5f",img_uid:a},c,c)}}]),angular.module("ngSwApp").controller("FacesettingsCtrl",["$routeParams","betaface","toastr","$location","userFace",function(a,b,c,d,e){function f(a){return b.getInfo(a)}function g(a){if(0!==a.int_response)c.warning(a.string_response,"Photon pattern recognition failed"),j();else{if(!(a.faces.length>1)){var b={},e=a.faces[0],f=e.tags;console.log(e.tags);for(var g=0;g<f.length;g++){var h=i(f[g].name);b[h]=f[g].value}return console.log(b),b}c.error("Let's try again","Multiple organisms detected"),d.path("/")}}function h(a){return l>=10?(c.warning("Manual processing fallback engaged","Photon pattern recognition failed"),void j()):void f(a).$promise.then(function(b){return 1===b.int_response?(l++,void setTimeout(function(){h(a)},2e3)):(e.setFaceData(g(b)),k.faceData=e.getFaceData(),void(k.ready=!0))},function(){c.warning("Manual processing fallback engaged","Photon pattern recognition failed"),j()})}function i(a){return a.replace(/(?:^\w|[A-Z]|\b\w)/g,function(a,b){return 0===b?a.toLowerCase():a.toUpperCase()}).replace(/\s+/g,"")}function j(){k.uid="",k.faceData=e.getEmptyModel(),k.ready=!0}var k=this;k.ready=!1,k.uid=a.uid||"",k.faceData={};var l=0;k.uid&&""!==k.uid?h(k.uid):j(),k.updateAndContinue=function(){e.setFaceDataNormalized(k.faceData),d.path("/processing")}}]),angular.module("ngSwApp").directive("faceForm",[function(){return{templateUrl:"views/directives/faceform.html",scope:{model:"="},restrict:"E",link:function(a,b,c){a.availableOptions={gender:["female","male"],side:["dark","light"]};var d=["eyeColour","hairColour","skinColour"],e=["age"],f=["gender","side"];a.isText=function(a){return e.indexOf(a)>-1},a.isDropdown=function(a){return f.indexOf(a)>-1},a.isColour=function(a){return d.indexOf(a)>-1}}}}]),angular.module("ngSwApp").service("guid",[function(){this.generate=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}}]),angular.module("ngSwApp").controller("SwapitestCtrl",["swapi",function(a){var b=this;b.ready=!1,a.people.all().then(function(a){b.people=a,b.ready=!0})}]),angular.module("ngSwApp").service("userFace",function(){var a={};this.setFaceData=function(b){a.age=b.age,a.gender=b.gender,a.side="yes"===b.smile?"light":"dark",a.eyeColour=b.colorEyes,a.skinColour=b.colorSkin,a.hairColour=b.colorHair?b.colorHair:"997058",console.log("updated userFace",a)},this.setFaceDataNormalized=function(b){a=b},this.getFaceData=function(){return a},this.getEmptyModel=function(){return{age:"",gender:"",side:"",eyeColour:"",skinColour:"",hairColour:""}}}),angular.module("ngSwApp").service("colourMapper",function(){var a={colors:[{name:"blue",hex:"0000FF"},{name:"yellow",hex:"FFFF00"},{name:"red",hex:"FF0000"},{name:"brown",hex:"6A3A0A"},{name:"blue-gray",hex:"8F8FFF"},{name:"black",hex:"000000"},{name:"orange",hex:"FFA500"},{name:"hazel",hex:"FFCA23"},{name:"pink",hex:"FFB2C2"},{name:"unknown",hex:"FFF3C0"},{name:"red, blue",hex:"FFB8C7"},{name:"gold",hex:"FFCA23"},{name:"green, yellow",hex:"E0D823"},{name:"white",hex:"CCCCCC"},{name:"dark",hex:"524729"}]},b={colors:[{name:"fair",hex:"FFE0BD"},{name:"gold",hex:"FFD700"},{name:"white, blue",hex:"C2BDFF"},{name:"white",hex:"FAFAFA"},{name:"light",hex:"FFEEDB"},{name:"white, red",hex:"FFBBBB"},{name:"unknown",hex:"666666"},{name:"green",hex:"77FF77"},{name:"green-tan, brown",hex:"CCF179"},{name:"pale",hex:"FFE8DE"},{name:"metal",hex:"E3CFC5"},{name:"dark",hex:"D7B998"},{name:"brown mottle",hex:"9C856A"},{name:"brown",hex:"B59369"},{name:"grey",hex:"AAAAAA"},{name:"mottled green",hex:"80A16A"},{name:"orange",hex:"D47B4A"},{name:"blue, grey",hex:"AFBEE4"},{name:"grey, red",hex:"F17D6F"},{name:"red",hex:"FF2222"},{name:"blue",hex:"2222FF"},{name:"grey, blue",hex:"A49CF1"},{name:"grey, green, yellow",hex:"FBE6A1"},{name:"yellow",hex:"FFF21F"},{name:"tan",hex:"BA581F"},{name:"fair, green, yellow",hex:"F3ED30"},{name:"silver, red",hex:"FF9276"},{name:"green, grey",hex:"91F2AC"},{name:"red, blue, white",hex:"F4AACC"},{name:"brown, white",hex:"B88975"},{name:"none",hex:"00000A"}]};this.compare=function(a,b){return a.distance<b.distance?-1:a.distance>b.distance?1:0},this.getClosestSkin=function(a){for(var c=[],d=0;d<b.colors.length;d++)c[d].name=b.colors[d].name,c[d].distance=this.getHexProximity(a,b.colors[d].hex);return c.sort(this.compare),c},this.getSkinHex=function(a){return"undefined"!=typeof b[a]?b[a]:!1},this.getEyeHex=function(b){return"undefined"!=typeof a[b]?a[b]:!1},this.getHexProximity=function(a,b){var c=this.splitHex(a),d=this.splitHex(b),e=[this.hexToInt(c[0]),this.hexToInt(c[1]),this.hexToInt(c[2])],f=[this.hexToInt(d[0]),this.hexToInt(d[1]),this.hexToInt(d[2])],g=this.rgbToXyz(e[0],e[1],e[2]),h=this.rgbToXyz(f[0],f[1],f[2]),i=this.xyzToLab(g[0],g[1],g[2]),j=this.xyzToLab(h[0],h[1],h[2]),k=this.cie1994(i,j,!1);return k},this.hexToInt=function(a){var b=a.toString(16);return parseInt(b,16)},this.splitHex=function(a){return[a.substr(0,2),a.substr(2,2),a.substr(4,2)]},this.rgbToXyz=function(a,b,c){var d=a/255,e=b/255,f=c/255;d>.04045?d=Math.pow((d+.055)/1.055,2.4):d/=12.92,e>.04045?e=Math.pow((e+.055)/1.055,2.4):e/=12.92,f>.04045?f=Math.pow((f+.055)/1.055,2.4):f/=12.92,d=100*d,e=100*e,f=100*f;var g=.4124*d+.3576*e+.1805*f,h=.2126*d+.7152*e+.0722*f,i=.0193*d+.1192*e+.9505*f;return[g,h,i]},this.xyzToLab=function(a,b,c){var d=95.047,e=100,f=108.883,g=a/d,h=b/e,i=c/f;g=g>.008856?Math.pow(g,1/3):7.787*g+16/116,h=h>.008856?Math.pow(h,1/3):7.787*h+16/116,i=i>.008856?Math.pow(i,1/3):7.787*i+16/116;var j=116*h-16,k=500*(g-h),l=200*(h-i);return[j,k,l]},this.cie1994=function(a,b,c){a={l:a[0],a:a[1],b:a[2]},b={l:b[0],a:b[1],b:b[2]};var d,e,f,g=1,h=1;c?(d=.014,e=.048,f=2):(d=.015,e=.045,f=1);var i=Math.sqrt(a.a*a.a+a.b*a.b),j=Math.sqrt(b.a*b.a+b.b*b.b),k=1+d*i,l=1+e*i,m=1,n=a.a-b.a,o=a.b-b.b,p=i-j,q=a.l-b.l,r=Math.sqrt(n*n+o*o-p*p);return Math.sqrt(Math.pow(q/(f*m),2)+Math.pow(p/(h*l),2)+Math.pow(r/(g*k),2))}}),angular.module("ngSwApp").controller("ProcessingCtrl",["$location","swapi","userFace","patryksMagic",function(a,b,c,d){var e=this,f=c.getFaceData();e.processing=!0,b.people.all().then(function(a){e.swapiData=a,console.log(a);var b=d.getParent(f.hairColour,f.skinColour,f.eyeColour,f.age,f.side,f.gender,a.results);e.resultText=b.name+" is your father",e.processing=!1})}]),angular.module("colorpicker.module",[]).factory("Helper",function(){return{closestSlider:function(a){var b=a.matches||a.webkitMatchesSelector||a.mozMatchesSelector||a.msMatchesSelector;return b.bind(a)("I")?a.parentNode:a},getOffset:function(a,b){for(var c=0,d=0,e=0,f=0;a&&!isNaN(a.offsetLeft)&&!isNaN(a.offsetTop);)c+=a.offsetLeft,d+=a.offsetTop,b||"BODY"!==a.tagName?(e+=a.scrollLeft,f+=a.scrollTop):(e+=document.documentElement.scrollLeft||a.scrollLeft,f+=document.documentElement.scrollTop||a.scrollTop),a=a.offsetParent;return{top:d,left:c,scrollX:e,scrollY:f}},stringParsers:[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)/,parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],a[4]]}},{re:/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/,parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/,parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}]}}).factory("Color",["Helper",function(a){return{value:{h:1,s:1,b:1,a:1},rgb:function(){var a=this.toRGB();return"rgb("+a.r+","+a.g+","+a.b+")"},rgba:function(){var a=this.toRGB();return"rgba("+a.r+","+a.g+","+a.b+","+a.a+")"},hex:function(){return this.toHex()},RGBtoHSB:function(a,b,c,d){a/=255,b/=255,c/=255;var e,f,g,h;return g=Math.max(a,b,c),h=g-Math.min(a,b,c),e=0===h?null:g===a?(b-c)/h:g===b?(c-a)/h+2:(a-b)/h+4,e=(e+360)%6*60/360,f=0===h?0:h/g,{h:e||1,s:f,b:g,a:d||1}},setColor:function(b){b=b.toLowerCase();for(var c in a.stringParsers)if(a.stringParsers.hasOwnProperty(c)){var d=a.stringParsers[c],e=d.re.exec(b),f=e&&d.parse(e);if(f)return this.value=this.RGBtoHSB.apply(null,f),!1}},setHue:function(a){this.value.h=1-a},setSaturation:function(a){this.value.s=a},setLightness:function(a){this.value.b=1-a},setAlpha:function(a){this.value.a=parseInt(100*(1-a),10)/100},toRGB:function(a,b,c,d){a||(a=this.value.h,b=this.value.s,c=this.value.b),a*=360;var e,f,g,h,i;return a=a%360/60,i=c*b,h=i*(1-Math.abs(a%2-1)),e=f=g=c-i,a=~~a,e+=[i,h,0,0,h,i][a],f+=[h,i,i,h,0,0][a],g+=[0,0,h,i,i,h][a],{r:Math.round(255*e),g:Math.round(255*f),b:Math.round(255*g),a:d||this.value.a}},toHex:function(a,b,c,d){var e=this.toRGB(a,b,c,d);return"#"+(1<<24|parseInt(e.r,10)<<16|parseInt(e.g,10)<<8|parseInt(e.b,10)).toString(16).substr(1)}}}]).factory("Slider",["Helper",function(a){var b={maxLeft:0,maxTop:0,callLeft:null,callTop:null,knob:{top:0,left:0}},c={};return{getSlider:function(){return b},getLeftPosition:function(a){return Math.max(0,Math.min(b.maxLeft,b.left+((a.pageX||c.left)-c.left)))},getTopPosition:function(a){return Math.max(0,Math.min(b.maxTop,b.top+((a.pageY||c.top)-c.top)))},setSlider:function(d,e){var f=a.closestSlider(d.target),g=a.getOffset(f,e),h=f.getBoundingClientRect(),i=d.clientX-h.left,j=d.clientY-h.top;b.knob=f.children[0].style,b.left=d.pageX-g.left-window.pageXOffset+g.scrollX,b.top=d.pageY-g.top-window.pageYOffset+g.scrollY,c={left:d.pageX-(i-b.left),top:d.pageY-(j-b.top)}},setSaturation:function(a,c){b={maxLeft:100,maxTop:100,callLeft:"setSaturation",callTop:"setLightness"},this.setSlider(a,c)},setHue:function(a,c){b={maxLeft:0,maxTop:100,callLeft:!1,callTop:"setHue"},this.setSlider(a,c)},setAlpha:function(a,c){b={maxLeft:0,maxTop:100,callLeft:!1,callTop:"setAlpha"},this.setSlider(a,c)},setKnob:function(a,c){b.knob.top=a+"px",b.knob.left=c+"px"}}}]).directive("colorpicker",["$document","$compile","Color","Slider","Helper",function(a,b,c,d,e){return{require:"?ngModel",restrict:"A",link:function(f,g,h,i){var j,k=h.colorpicker?h.colorpicker:"hex",l=angular.isDefined(h.colorpickerPosition)?h.colorpickerPosition:"bottom",m=angular.isDefined(h.colorpickerInline)?h.colorpickerInline:!1,n=angular.isDefined(h.colorpickerFixedPosition)?h.colorpickerFixedPosition:!1,o=angular.isDefined(h.colorpickerParent)?g.parent():angular.element(document.body),p=angular.isDefined(h.colorpickerWithInput)?h.colorpickerWithInput:!1,q=p?'<input type="text" name="colorpicker-input">':"",r=m?"":'<button type="button" class="close close-colorpicker">&times;</button>',s='<div class="colorpicker dropdown"><div class="dropdown-menu"><colorpicker-saturation><i></i></colorpicker-saturation><colorpicker-hue><i></i></colorpicker-hue><colorpicker-alpha><i></i></colorpicker-alpha><colorpicker-preview></colorpicker-preview>'+q+r+"</div></div>",t=angular.element(s),u=c,v=t.find("colorpicker-hue"),w=t.find("colorpicker-saturation"),x=t.find("colorpicker-preview"),y=t.find("i");if(b(t)(f),p){var z=t.find("input");z.on("mousedown",function(a){a.stopPropagation()}).on("keyup",function(a){var b=this.value;g.val(b),i&&f.$apply(i.$setViewValue(b)),a.stopPropagation(),a.preventDefault()}),g.on("keyup",function(){z.val(g.val())})}var A=function(){a.on("mousemove",C),a.on("mouseup",D)};"rgba"===k&&(t.addClass("alpha"),j=t.find("colorpicker-alpha"),j.on("click",function(a){d.setAlpha(a,n),C(a)}).on("mousedown",function(a){d.setAlpha(a,n),A()}).on("mouseup",function(a){I("colorpicker-selected-alpha")})),v.on("click",function(a){d.setHue(a,n),C(a)}).on("mousedown",function(a){d.setHue(a,n),A()}).on("mouseup",function(a){I("colorpicker-selected-hue")}),w.on("click",function(a){d.setSaturation(a,n),C(a),angular.isDefined(h.colorpickerCloseOnSelect)&&J()}).on("mousedown",function(a){d.setSaturation(a,n),A()}).on("mouseup",function(a){I("colorpicker-selected-saturation")}),n&&t.addClass("colorpicker-fixed-position"),t.addClass("colorpicker-position-"+l),"true"===m&&t.addClass("colorpicker-inline"),o.append(t),i&&(i.$render=function(){g.val(i.$viewValue)},f.$watch(h.ngModel,function(a){E(),p&&z.val(a)})),g.on("$destroy",function(){t.remove()});var B=function(){try{x.css("backgroundColor",u[k]())}catch(a){x.css("backgroundColor",u.toHex())}w.css("backgroundColor",u.toHex(u.value.h,1,1,1)),"rgba"===k&&(j.css.backgroundColor=u.toHex())},C=function(a){var b=d.getLeftPosition(a),c=d.getTopPosition(a),e=d.getSlider();d.setKnob(c,b),e.callLeft&&u[e.callLeft].call(u,b/100),e.callTop&&u[e.callTop].call(u,c/100),B();var h=u[k]();return g.val(h),i&&f.$apply(i.$setViewValue(h)),p&&z.val(h),!1},D=function(){I("colorpicker-selected"),a.off("mousemove",C),a.off("mouseup",D)},E=function(){u.setColor(g.val()),y.eq(0).css({left:100*u.value.s+"px",top:100-100*u.value.b+"px"}),y.eq(1).css("top",100*(1-u.value.h)+"px"),y.eq(2).css("top",100*(1-u.value.a)+"px"),B()},F=function(){var a,b=e.getOffset(g[0]);return angular.isDefined(h.colorpickerParent)&&(b.left=0,b.top=0),"top"===l?a={top:b.top-147,left:b.left}:"right"===l?a={top:b.top,left:b.left+126}:"bottom"===l?a={top:b.top+g[0].offsetHeight+2,left:b.left}:"left"===l&&(a={top:b.top,left:b.left-150}),{top:a.top+"px",left:a.left+"px"}},G=function(){J()},H=function(){t.hasClass("colorpicker-visible")||(E(),t.addClass("colorpicker-visible").css(F()),I("colorpicker-shown"),m===!1&&a.on("mousedown",G),h.colorpickerIsOpen&&(f[h.colorpickerIsOpen]=!0,f.$$phase||f.$digest()))};m===!1?g.on("click",H):H(),t.on("mousedown",function(a){a.stopPropagation(),a.preventDefault()});var I=function(a){i&&f.$emit(a,{name:h.ngModel,value:i.$modelValue})},J=function(){t.hasClass("colorpicker-visible")&&(t.removeClass("colorpicker-visible"),I("colorpicker-closed"),a.off("mousedown",G),h.colorpickerIsOpen&&(f[h.colorpickerIsOpen]=!1,f.$$phase||f.$digest()))};t.find("button").on("click",function(){J()}),h.colorpickerIsOpen&&f.$watch(h.colorpickerIsOpen,function(a){a===!0?H():a===!1&&J()})}}}]),angular.module("ngSwApp").directive("hexcode",function(){return{require:"ngModel",link:function(a,b,c,d){d.$formatters.push(function(a){return"#"+a}),d.$parsers.push(function(a){return a.replace(/^\#/,"")})}}}),angular.module("ngSwApp").service("patryksMagic",function(){function a(a,b){return a.distance<b.distance?-1:a.distance>b.distance?1:0}function b(b,d){for(var e=[],f=0;f<d.colors.length;f++)e[f]={name:"n/a",distance:99999},e[f].name=d.colors[f].name,e[f].distance=c(b,d.colors[f].hex);return e.sort(a)}function c(a,b){var c=e(a),i=e(b),j=[d(c[0]),d(c[1]),d(c[2])],k=[d(i[0]),d(i[1]),d(i[2])],l=f(j[0],j[1],j[2]),m=f(k[0],k[1],k[2]),n=g(l[0],l[1],l[2]),o=g(m[0],m[1],m[2]),p=h(n,o,!1);return p}function d(a){var b=a.toString(16);return parseInt(b,16)}function e(a){return[a.substr(0,2),a.substr(2,2),a.substr(4,2)]}function f(a,b,c){var d=a/255,e=b/255,f=c/255;d>.04045?d=Math.pow((d+.055)/1.055,2.4):d/=12.92,e>.04045?e=Math.pow((e+.055)/1.055,2.4):e/=12.92,f>.04045?f=Math.pow((f+.055)/1.055,2.4):f/=12.92,d=100*d,e=100*e,f=100*f;var g=.4124*d+.3576*e+.1805*f,h=.2126*d+.7152*e+.0722*f,i=.0193*d+.1192*e+.9505*f;return[g,h,i]}function g(a,b,c){var d=95.047,e=100,f=108.883,g=a/d,h=b/e,i=c/f;g=g>.008856?Math.pow(g,1/3):7.787*g+16/116,h=h>.008856?Math.pow(h,1/3):7.787*h+16/116,i=i>.008856?Math.pow(i,1/3):7.787*i+16/116;var j=116*h-16,k=500*(g-h),l=200*(h-i);return[j,k,l]}function h(a,b,c){a={l:a[0],a:a[1],b:a[2]},b={l:b[0],a:b[1],b:b[2]};var d,e,f,g=1,h=1;c?(d=.014,e=.048,f=2):(d=.015,e=.045,f=1);var i=Math.sqrt(a.a*a.a+a.b*a.b),j=Math.sqrt(b.a*b.a+b.b*b.b),k=1+d*i,l=1+e*i,m=1,n=a.a-b.a,o=a.b-b.b,p=i-j,q=a.l-b.l,r=Math.sqrt(n*n+o*o-p*p);return Math.sqrt(Math.pow(q/(f*m),2)+Math.pow(p/(h*l),2)+Math.pow(r/(g*k),2))}function i(a,b,c,d,e,f,g){t=g,j(a,b,c,d,e,f);var h=m(a,b,c,d,e,f);return h[0]}function j(a,c,d,e,f,g){n=b(a,r),o=b(d,q),p=b(c,s)}function k(a,b){for(var c=0,d=0;d<a.length;d++)a[d].name===b&&(c=a[d].distance);return c}function l(a,b){var c=b;return null!==a&&a.length>0&&(isNaN(a)||(c=parseInt(a))),c}function m(b,c,d,e,f,g){for(var h=[],i=0;i<t.length;i++){var j=t[i].skin_color,m=t[i].eye_color,q=t[i].hair_color;h[i]={name:"n/a",distance:0,originalIndex:0},h[i].name=t[i].name;var r=k(p,j),s=k(n,q),u=k(o,m);if(h[i].distance=r+s+u,h[i].originalIndex=i,t[i].birth_year){var v=t[i].birth_year.replace("BBY",""),w=l(v,30),x=w-e;h[i].name=h[i].name,h[i].distance=h[i].distance+Math.sqrt(Math.abs(x))}}return h.sort(a)}this.getParent=i;var n,o,p,q={colors:[{name:"blue",hex:"0000FF"},{name:"yellow",hex:"FFFF00"},{name:"red",hex:"FF0000"},{name:"brown",hex:"6A3A0A"},{name:"blue-gray",hex:"8F8FFF"},{name:"black",hex:"000000"},{name:"orange",hex:"FFA500"},{name:"hazel",hex:"FFCA23"},{name:"pink",hex:"FFB2C2"},{name:"unknown",hex:"FFF3C0"},{name:"red, blue",hex:"FFB8C7"},{name:"gold",hex:"FFCA23"},{name:"green, yellow",hex:"E0D823"},{name:"white",hex:"CCCCCC"},{name:"dark",hex:"524729"}]},r={colors:[{name:"blond",hex:"F2DA91"},{name:"n/a",hex:"997058"},{name:"none",hex:"373833"},{name:"brown",hex:"A0522D"},{name:"brown, grey",hex:"D2B48C"},{name:"black",hex:"000000"},{name:"auburn, white",hex:"B08D8D"},{name:"auburn, grey",hex:"A56A6A"},{name:"white",hex:"E8E6E6"},{name:"grey",hex:"A6A4A4"},{name:"auburn",hex:"A52A2A"},{name:"blonde",hex:"F2DA91"},{name:"unknown",hex:"7A7777"}]},s={colors:[{name:"fair",hex:"FFE0BD"},{name:"gold",hex:"FFD700"},{name:"white, blue",hex:"C2BDFF"},{name:"white",hex:"FAFAFA"},{name:"light",hex:"FFEEDB"},{name:"white, red",hex:"FFBBBB"},{name:"unknown",hex:"666666"},{name:"green",hex:"77FF77"},{name:"green-tan, brown",hex:"CCF179"},{name:"pale",hex:"FFE8DE"},{name:"metal",hex:"E3CFC5"},{name:"dark",hex:"D7B998"},{name:"brown mottle",hex:"9C856A"},{name:"brown",hex:"B59369"},{name:"grey",hex:"AAAAAA"},{name:"mottled green",hex:"80A16A"},{name:"orange",hex:"D47B4A"},{name:"blue, grey",hex:"AFBEE4"},{name:"grey, red",hex:"F17D6F"},{name:"red",hex:"FF2222"},{name:"blue",hex:"2222FF"},{name:"grey, blue",hex:"A49CF1"},{name:"grey, green, yellow",hex:"FBE6A1"},{name:"yellow",hex:"FFF21F"},{name:"tan",hex:"BA581F"},{name:"fair, green, yellow",hex:"F3ED30"},{name:"silver, red",hex:"FF9276"},{name:"green, grey",hex:"91F2AC"},{name:"red, blue, white",hex:"F4AACC"},{name:"brown, white",hex:"B88975"},{name:"none",hex:"00000A"}]},t=[]}),angular.module("ngSwApp").run(["$templateCache",function(a){a.put("views/about.html","<p>This is the about view.</p>"),a.put("views/directives/faceform.html",'<form> <div ng-repeat="(prop, val) in model" class="form-group"> <label>{{prop}}</label> <!-- text --> <input type="text" class="form-control" ng-if="isText(prop)" ng-model="model[prop]"> <input type="text" class="form-control" colorpicker="hex" hexcode ng-if="isColour(prop)" ng-model="model[prop]"> <!-- end text --> <!-- dropdown --> <select class="form-control" ng-if="isDropdown(prop)" ng-model="model[prop]"> <option ng-repeat="optionVal in availableOptions[prop]">{{optionVal}}</option> </select> <!-- end dropdown --> </div> </form>'),a.put("views/facesettings.html",'<h1 ng-show="faceSettings.uid.length && !faceSettings.ready">Waiting on analytic droids to identify your facial features...</h1> <h1 ng-show="faceSettings.uid.length && faceSettings.ready">Here\'s what our analytic droids make of you</h1> <h1 ng-show="!faceSettings.uid.length">Analytic droids were unable to fully identify your facial features. Please enter them below.</h1> <div class="row"> <div class="col-sm-12"> <face-form ng-show="faceSettings.ready" model="faceSettings.faceData"></face-form> </div> </div> <div class="row"> <br> <div class="col-sm-12"> <a ng-show="faceSettings.ready" ng-click="faceSettings.updateAndContinue()" class="btn btn-block btn-success">Continue</a> </div> </div>'),a.put("views/main.html",'<div class="jumbotron"> <webcam></webcam> </div>'),a.put("views/processing.html",'<div class="star-wars" ng-show="!processing.processing"> <h1 ng-show="!processing.processing">{{processing.resultText}}</h1> <div id="space"> <div class="stars"></div> <div class="stars"></div> <div class="stars"></div> <div class="stars"></div> <div class="stars"></div> </div> </div> <p>This is the processing view.</p> <h1 ng-show="processing.processing">Processing</h1> <h1 ng-show="!processing.processing">Ready</h1> {{processing.swapiData}} {{processing.userFace}}'),a.put("views/swapitest.html",'<div ng-show="swapitest.ready" ng-repeat="person in swapitest.people">{{person}}</div> <div ng-show="!swapitest.ready">Loading</div>')}]);